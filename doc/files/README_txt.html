<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: README.txt</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>README.txt</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>README.txt
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Sat Jul 11 13:27:35 -0400 2009</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
cosell
</p>
<pre>
    by Steven Swerling
    http://tab-a.slot-z.net
</pre>
<h2>DESCRIPTION:</h2>
<p>
<a href="../classes/Cosell.html">Cosell</a> is a minimal implementation of
the &#8216;Announcements&#8217; observer framework, originally introduced
in VisualWorks Smalltalk 7.4 as a replacement for
&#8216;triggerEvent&#8217; style of event notification. Instead of
triggering events identified by symbols, the events are first class
objects. For rationale, please see the original blog posting by Vassili
Bykov (refs below).
</p>
<p>
<b>Lineage</b>
</p>
<p>
This implementation is loosely based on Lukas Renggli&#8216;s tweak of
Colin Putney&#8216;s Squeak implementation of Vassili Bykov&#8216;s
Announcements framework for VisualWorks Smalltalk. (Specifically
Announcements-lr.13.mcz was used as a reference.)
</p>
<p>
Liberties where taken during the port. In particular, the Announcer class
in the Smalltalk version is implemented here as a ruby module which can be
mixed into any object. Also, in this implementation any object (or class)
can serve as an announcement, so no Announcement class is implemented.
</p>
<p>
<b>The Name &#8216;<a href="../classes/Cosell.html">Cosell</a>&#8216;</b>
</p>
<p>
I chose the name &#8216;<a href="../classes/Cosell.html">Cosell</a>&#8217;
because
</p>
<ol>
<li type="a">Howard <a href="../classes/Cosell.html">Cosell</a> is an iconic event
announcer

</li>
<li type="a">Googling for &#8216;Ruby Announcements&#8217;, &#8216;Ruby Event
Announcements&#8217;, etc., produced scads of results about ruby meetups,
conferences, and the like. So I went with something a bit cryptic but
hopefully a little more searchable.

</li>
</ol>
<p>
<b>See</b>
</p>
<ul>
<li><a
href="http://www.cincomsmalltalk.com/userblogs/vbykov/blogView?entry=3310034894">Original
blog posting describing Announcments by Vassili Bykov</a>

</li>
<li><a href="http://wiki.squeak.org/squeak/5734">More info on the Announcements
Framework</a>

</li>
</ul>
<h2>FEATURES/PROBLEMS:</h2>
<ul>
<li>None known. Should work in ruby 1.8 and 1.9.

</li>
</ul>
<h2>SYNOPSIS:</h2>
<pre>
  (this example is in the [gem]/example/basic_example.rb file)

  #
  #  Will produce the following output:
  #
  #       And now a word from our sponsor: 'the'
  #       End of round 1
  #       End of round 2
  #       End of round 3
  #       End of round 4
  #       End of round 5
  #       End of round 6
  #       End of round 7
  #       End of round 8
  #       End of round 9
  #       End of round 10
  #       End of round 11
  #       End of round 12
  #       End of round 13
  #       End of round 14
  #       TKO!

  require 'rubygems'
  require 'cosell'

  # An announcer
  class Howard
    include Cosell
  end

  # a receiver of the announcements
  class Television
    def show(ann, opts={})
      puts ann.to_s(opts)
    end
  end

  # Some announcements
  class Announcement
    def to_s(opts={})
      self.class.to_s + '!'
    end
  end
  class WordFromOurSponsor &lt; Announcement
    attr_accessor :word
    def to_s(opts={})
      &quot;And now a word from our sponsor: '#{word}'&quot;
    end
  end
  class EndOfRound &lt; Announcement
    def to_s(opts={})
      &quot;End of round #{opts[:round]}&quot;
    end
  end
  class KnockOut &lt; Announcement; end
  class TKO &lt; KnockOut; end

  # ------- Start announcing -------

  # Create an announcer, and a subscriber
  round = 1
  howard = Howard.new
  tv = Television.new
  howard.when_announcing(WordFromOurSponsor, KnockOut) { |ann| tv.show(ann) }

  # Make an announcement
  announcement = WordFromOurSponsor.new
  announcement.word = 'the'
  howard.announce(announcement)
    # =&gt; And know a word from our sponsors: 'the'

  # Make another announcement
  howard.announce(EndOfRound)
    # =&gt; nothing, you haven't subscribed yet to EndOfRound. Tree fell, nobody heard. Didn't happen.

  # Create a second subscription
  eor_subscription = lambda do |ann|
    tv.show(ann, :round =&gt; round)
    round += 1
  end
  howard.when_announcing(EndOfRound, &amp;eor_subscription)

  # Tell the announcer to use a background announcments queue
  # Only allow the announcer to broadcast 5 announcments at a time
  # before going to sleep for 0.05 seconds
  howard.queue_announcements!(:sleep_time =&gt; 0.05, :announcements_per_cycle =&gt; 5)

  # Start making announcments (they will be queueud in the background)
  14.times {howard.announce(EndOfRound)}

  sleep 0.05 # announcements for the first 5 rounds appear
  sleep 0.05 # announcements for the next 5 rounds
  sleep 0.05 # announcements for end of the next 4 rounds (there is not 15th round
  sleep 0.05 # no announcements, all the announcements have been announced

  # queue the final announcment
  howard.announce(TKO)
      # =&gt; TKO!

  sleep 0.05 # the TKO is broadcast
</pre>
<h2>REQUIREMENTS:</h2>
<ul>
<li>ruby, rubygems

</li>
</ul>
<h2>INSTALL:</h2>
<ul>
<li>TODO: sudo gem install swerling-cosell

</li>
</ul>
<h2>LICENSE:</h2>
<p>
(The MIT License)
</p>
<p>
Copyright (c) 2008
</p>
<p>
Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
&#8216;Software&#8217;), to deal in the Software without restriction,
including without limitation the rights to use, copy, modify, merge,
publish, distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to the
following conditions:
</p>
<p>
The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
</p>
<p>
THE SOFTWARE IS PROVIDED &#8216;AS IS&#8217;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
USE OR OTHER DEALINGS IN THE SOFTWARE.
</p>

    </div>


   </div>


  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>